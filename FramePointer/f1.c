#include <stdio.h>
#include <string.h>
#include <stdlib.h>
int limit, c;

int getebp()
{
	__asm__("movl %ebp, %eax");
}

void f(char *s)
{
	int *i;
	char buf[256];
	i = (int *)getebp();
	limit = *i-(int)buf + 1;
	for (c = 0; c < limit && s[c] != '\0'; c++)
		buf[c] = s[c];

}

int main(int argc, char **argv)
{
	int cookie = 1000;
	f(argv[1]);
	if (cookie == 0xdefaced)
	{
		setresuid(geteuid(),geteuid(),geteuid());
		execlp("/bin/sh","/bin/sh","-i",NULL);
	}
	return 0;
}